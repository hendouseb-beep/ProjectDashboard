<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Projets</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <header>
    <h1>Grafen – Project Tracker</h1>
  </header>

  <!-- Statistiques -->
  <section id="stats">
    <div class="stat">
      <h2>Tous les projets</h2>
      <p id="total-count">0</p>
    </div>
    <div class="stat"><h2>En cours</h2><p id="en-cours-count">0</p></div>
    <div class="stat"><h2>Terminés</h2><p id="termine-count">0</p></div>
    <div class="stat"><h2>En attente</h2><p id="attente-count">0</p></div>
    <div class="stat"><h2>Retardés</h2><p id="retarde-count">0</p></div>
  </section>

  <!-- Filtres -->
  <section id="filters">
    <label for="statusFilter">Filtrer par statut :</label>
    <select id="statusFilter">
      <option value="Tous">Tous</option>
      <option value="En cours">En cours</option>
      <option value="Terminé">Terminé</option>
      <option value="En attente">En attente</option>
      <option value="Retardé">Retardé</option>
    </select>
  </section>

  <!-- Formulaire d'ajout -->
  <section id="add-project">
    <h2>Ajouter un projet</h2>
    <form action="{{ url_for('add_project') }}" method="POST">
      <label>Client :</label>
      <input type="text" name="owner" required />

      <label>Nom du projet :</label>
      <input type="text" name="name" required />

      <label>Statut :</label>
      <select name="status">
        <option value="En cours">En cours</option>
        <option value="Terminé">Terminé</option>
        <option value="En attente">En attente</option>
        <option value="Retardé">Retardé</option>
      </select>

      <label>Date de début :</label>
      <input type="date" name="start_date" required />

      <label>Date de fin :</label>
      <input type="date" name="end_date" required />

      <label>Équipe (nombre de personnes) :</label>
      <input type="number" name="team" required />

      <label>Progression (%) :</label>
      <input type="number" name="progress" min="0" max="100" value="0" required />

      <button type="submit">Ajouter le projet</button>
    </form>
  </section>

  <!-- Liste des projets -->
  <section id="projects" class="project-grid">
    {% for project in projects %}
    <div class="card" data-status="{{ project.status }}">
      <h3>{{ project.owner }}</h3>
      <p class="title">{{ project.name }}</p>
      <p><strong>Statut :</strong> {{ project.status }}</p>
      <div class="progress-bar">
        <div style="width: {{ project.progress }}%;"></div>
      </div>
      <p><strong>Progression :</strong> {{ project.progress }}%</p>
      <p><strong>Échéance :</strong> {{ project.end_date }}</p>
      <p><strong>Équipe :</strong> {{ project.team }}</p>

      <!-- 🔹 Bouton pour modifier -->
      <form action="{{ url_for('edit_project', index=loop.index0) }}" method="GET">
        <button type="submit">✏️ Modifier</button>
      </form>
      <form action="{{ url_for('delete_project', index=loop.index0) }}" method="POST" style="display:inline;">
  <button type="submit" class="delete-btn" onclick="return confirm('Voulez-vous vraiment supprimer ce projet ?')">
    🗑️ Supprimer
  </button>
</form>

    </div>
    {% endfor %}
  </section>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
